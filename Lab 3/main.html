<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2020a"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S0 { border-left: 0.994318px solid rgb(233, 233, 233); border-right: 0.994318px solid rgb(233, 233, 233); border-top: 0.994318px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S1 { border-left: 0.994318px solid rgb(233, 233, 233); border-right: 0.994318px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { border-left: 0.994318px solid rgb(233, 233, 233); border-right: 0.994318px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0.994318px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S4 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S5 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S6 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S7 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }</style></head><body><div class = rtcContent><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%% EE525 Project 3</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Part 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Author: Grant Gallagher</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Clear Workspace</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>clear;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Chose Between FIR and IIR filter</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% type == 1: FIR</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% type == 2: IIR</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span>type = 1</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%% Procedure 1: Simulate the random sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>N = 50000;              </span><span style="color: rgb(60, 118, 61);">% Sequence size</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>X = normrnd(0,1,[1 N]); </span><span style="color: rgb(60, 118, 61);">% Generate Gaussian random sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>maxlag = 20;              </span><span style="color: rgb(60, 118, 61);">% Number of lag points to calculate</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Rx = xcorr(X,X,maxlag)/N; </span><span style="color: rgb(60, 118, 61);">% Autocorrelation of X[n]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>lags = linspace(-maxlag,maxlag,2*maxlag+1); </span><span style="color: rgb(60, 118, 61);">% Sequence of lags correlating to Rx</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(160, 32, 240);">'Position'</span><span>,[0 0 1000 400]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Subplot of random sample sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(1,2,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(X,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Index, {\itn}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Magnitude, {\itX[n]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>box </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Subplot of autocorrelation sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(1,2,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>stem(lags,Rx,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Lag, {\itm}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Autocorrelation, {\itR_x}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([-0.2 1.2])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span>box </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%% Procedure 2: Simulate the filter</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">if </span><span>type == 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span>b = [1 -1 1];      </span><span style="color: rgb(60, 118, 61);">% Numerator coefficients</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    a = [1  0 0];      </span><span style="color: rgb(60, 118, 61);">% Denominator coefficients</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">elseif </span><span>type == 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    b = [1 0];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    a = [1 -0.95];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Y = filter(b,a,X); </span><span style="color: rgb(60, 118, 61);">% Output of filtered random sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>var(Y);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Plot the PDF</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(160, 32, 240);">'Position'</span><span>,[0 0 500 400]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[f, Yi] = ksdensity(Y);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(Yi,f,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>[f, Xi] = ksdensity(X);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(Xi,f,</span><span style="color: rgb(160, 32, 240);">'-.'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>hold </span><span style="color: rgb(160, 32, 240);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Magnitude, {\itY[n]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Density, {\itP(Y[n])}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>legend(</span><span style="color: rgb(160, 32, 240);">'Y[n]'</span><span>, </span><span style="color: rgb(160, 32, 240);">' X[n]'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlim([-8 8])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>box </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Four Lag Plots</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(160, 32, 240);">'Position'</span><span>,[0 0 600 600]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(2,2,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(Y(1:end-1), Y(2:end),</span><span style="color: rgb(160, 32, 240);">'.'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,[0 0 0])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n+1]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>title(</span><span style="color: rgb(160, 32, 240);">'Lag of 1'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(2,2,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(Y(1:end-2), Y(3:end),</span><span style="color: rgb(160, 32, 240);">'.'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,[0 0 0])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n+2]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>title(</span><span style="color: rgb(160, 32, 240);">'Lag of 2'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(2,2,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(Y(1:end-3), Y(4:end),</span><span style="color: rgb(160, 32, 240);">'.'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,[0 0 0])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n+3]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>title(</span><span style="color: rgb(160, 32, 240);">'Lag of 3'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(2,2,4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(Y(1:end-4), Y(5:end),</span><span style="color: rgb(160, 32, 240);">'.'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,[0 0 0])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'{\itY[n+4]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span>title(</span><span style="color: rgb(160, 32, 240);">'Lag of 4'</span><span>)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%% Procedure 3: Autocorrelation Function</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>N = 50000;   </span><span style="color: rgb(60, 118, 61);">% Sequence size</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>maxlag = 20; </span><span style="color: rgb(60, 118, 61);">% Number of lag points to calculate</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>K = 1000;    </span><span style="color: rgb(60, 118, 61);">% Number of sample sequences for ensemble average</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Memory preallocation</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>X = zeros(K,N); </span><span style="color: rgb(60, 118, 61);">% Array of sample sequence inputs</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Y = zeros(K,N); </span><span style="color: rgb(60, 118, 61);">% Array of sample sequence ouputs</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">for </span><span>s = 1:K </span><span style="color: rgb(60, 118, 61);">% Calculate each sample sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    X(s,:) = randn([1 N]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% Y(s,:) = cos(2*pi/1000*linspace(1,N,N)).*(1+X(s,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    Y(s,:) = filter(b, a, X(s,:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Memory preallocation</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>x = zeros(1,N); </span><span style="color: rgb(60, 118, 61);">% Ensemble average of input</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>y = zeros(1,N); </span><span style="color: rgb(60, 118, 61);">% Ensemble average outputs</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">for </span><span>n = 1:N     </span><span style="color: rgb(60, 118, 61);">% Take the ensemble average</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    x(n) = average(X(:,n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    y(n) = average(Y(:,n));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Ry = xcorr(y,y,maxlag)/N*K; </span><span style="color: rgb(60, 118, 61);">% Autocorrelation of Y[n]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">if </span><span>type == 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    Ry_theoretical = [zeros([1 18]) [1 -2 3 -2 1] zeros([1 18])];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">elseif </span><span>type == 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    Ry_theoretical =[10.2564*(0.95.^(flip(m(2:end)))) (10.2564*(0.95.^(m)))]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(160, 32, 240);">'Position'</span><span>,[0 0 1000 400]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(1,2,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>stem(lags,Ry,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Lag, {\itm}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Autocorrelation Function, {\itR_Y[m]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(1,2,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>linspace(-20,20,41)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>stem(linspace(-20,20,41), Ry_theoretical,</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Lag, {\itm}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Autocorrelation Function, {\itR_Y[m]}'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%% Procedure 4: PSDs</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% FFT of y[n]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(160, 32, 240);">'Position'</span><span>,[0 0 1000 500]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sy = (abs(fft(y)).^2)/N*K;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sy = Sy(1:N/2+1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>f = (0:N/2)/N;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(3,1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(f*2,10*log10(Sy),</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>) </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>legend(</span><span style="color: rgb(160, 32, 240);">'FFT of Y[n]'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Location'</span><span>,</span><span style="color: rgb(160, 32, 240);">'NorthEast'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([-40 20])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% DTFT of Ry</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>maxlag = N-10;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Ry = xcorr(y,y,maxlag)/N*K;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sy = abs(fft(Ry));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sy = Sy(1:maxlag+1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>f = (0:maxlag)/maxlag;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(3,1,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(f,10*log10(Sy),</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Power Spectral Density, {\itS_Y} [dB]'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>legend(</span><span style="color: rgb(160, 32, 240);">'DTFT of R_Y'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Location'</span><span>,</span><span style="color: rgb(160, 32, 240);">'NorthEast'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([-40 20])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Analytical Solutiun</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>syms </span><span style="color: rgb(160, 32, 240);">F</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">if </span><span>type == 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    Sy = 3-4*cos(pi*F)+2*cos(2*pi*F);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">elseif </span><span>type == 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    Sy = 0.102586/((2*F)^2+0.002631) </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(3,1,3)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>fplot(10*log10(Sy),</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Normalized Sample Frequency, {\itf} [\pi\timesrad/sample]'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlim([0 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([-40 20])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>legend(</span><span style="color: rgb(160, 32, 240);">'Analytical Solution'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Location'</span><span>,</span><span style="color: rgb(160, 32, 240);">'NorthEast'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%% Prcedure 5: Compare I/O</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>N = 100000;              </span><span style="color: rgb(60, 118, 61);">% Sequence size</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>x = normrnd(0,1,[1 N]); </span><span style="color: rgb(60, 118, 61);">% Generate Gaussian random sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">if </span><span>type == 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    b = [1 -1 1];      </span><span style="color: rgb(60, 118, 61);">% Numerator coefficients</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    a = [1  0 0];      </span><span style="color: rgb(60, 118, 61);">% Denominator coefficients</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">elseif </span><span>type == 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    b = [1 0];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    a = [1 -0.95];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>y = filter(b,a,x); </span><span style="color: rgb(60, 118, 61);">% Output of filtered random sequence</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sx = (abs(fft(x)).^2)/N;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sx = Sx(1:N/2+1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sy = (abs(fft(y)).^2)/N;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>Sy = Sy(1:N/2+1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>f = (0:N/2)/N;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>figure(</span><span style="color: rgb(160, 32, 240);">'Position'</span><span>,[0 0 800 500]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(1,2,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(f*2,(Sx),</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Power Spectral Density, {\itS_X} [Mag]'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Normalized Sample Frequency, {\itf} [\pi\timesrad/sample]'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylim([0 80])</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>subplot(1,2,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>plot(f*2,(Sy),</span><span style="color: rgb(160, 32, 240);">'Color'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Black'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>ylabel(</span><span style="color: rgb(160, 32, 240);">'Power Spectral Density, {\itS_Y} [Mag]'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>xlabel(</span><span style="color: rgb(160, 32, 240);">'Normalized Sample Frequency, {\itf} [\pi\timesrad/sample]'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>grid </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span>ylim([0 80])</span></span></div></div></div><ol  class = 'S3'><li  class = 'S4'><span>Filter </span><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;X&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAAjCAYAAAAjS9I/AAAEDUlEQVRoQ+3ZaaitUxgH8N81C5kzfxFJhJIp80xkLvMUQqRQSsiUSCFTITJPmWdlDoX4gA8+EJlCZpIhor+eXW9v7znnPXffu53t3lWnvfd71l5r/Z/h//zXs2eZh8eseRi7UYPfA+t3GPwTPIA/hnDGyjgIi3as8SDebz8fNfhzsC++bh3kDVyE34YAvyYuxjKNNRbA2jgUr84E8B/iziFATueri+MK3D4ffMts/0XYj4Xnl8eR2Adbt4z2OB6p8P21SOZAHIJdG3Nfxml4s54l58cC/ADDcrgeB9SD5M9J+Lkj+TZBDJNcOws34PfGvLEDn7PviIewFJ7G4fimBX4hnF6gT8Dd+Ls1ZyzBr4LbsFN5POXquQawcMfBuK5K1mX4syMyxhJ8wJ2KgMq4Cmc0Qnpb3Ion6vkvE9SjsQQfLOvhPqyL18vTH9Xnm/EljsdXkxTisQUf2XgpTilwxxa5hQwzQoKfT6FAxhZ8cO1XGjzvX8C3WANH470e0qsP+EWwGjbCxtgc1xbhxgF74kRsiruKYHOOrjFHFV6T+LLZx6UFXuoBPFP6gM/FZ+dad8NGiv2IC7EiFi79kTX3xqOjAN8mvqRB6nkXs3edpw/4fG/gsXBI0irfOxevlbe3wCu1wS54ZhTgs8fueLI2axJfH+f3Bb9qqcftcBRWwmcN7RA1eU+LeOd62Ifpw+ybNXY6bBq3tL7gt8RTJYXzGgF1dpXWRF+iIH+JipTgSOy5Cj7WHzD787iydrsFJ2Oi2t48VF/wAXR5CarsFcWYUpqxNG4suZ2Kc9MkITdHCG+JKnNh3zD7Dw3F90WRTxoSU40+4COhw+6R0Fk7kRUDDMYGuL8+5L7xztwEP9DskbSp5W/xb/urqfii6dM0aGv59rn6gF8H9yJM31aSWS9dmTvKAPF8qsBEYyjPDzT7eTgOzZKWOvswUv6exRHlqcm83wf8XnVdzq0x5NpsP0UDXFKGz1ppfU1m8NkGH+Db12Ul4Nu3tKTCNcXGAbw/0igcBvyCVcvPLFFzDL5vLNisAilxMXoqwgf4tGPj2QY/uKyk3xZm7arlgxDMvl0hOt2wX6H6bbvV9bidSoMq8G6Ff5qWSY+rJzjftMHH4wGe62nyb4eSsl0e3aaRCl3kNF3wIdTHsGRHyDfz/e2S2cuWAJqo0kwLfNq855d+DutmvFiCIn31QQMj1k67Kmyb7s1gfFc3v4Rjmh9/tdBPlfNRdDH6RA2TtZDSunq95ord1VEabDst8FOk7ND/ngr80Bu0FpgPfib17aPU2lUhZPpTD50wWWREjyRV8yvNYCxW1SMqcEb8YnNBB4KpNHqfdGiKo/b8rWYC+D4gRjZn1L/YjAxYn43mg+9jpf/jnH8AyWkuM0v64eoAAAAASUVORK5CYII=" width="31.5" height="17.5" /></span><span> using (1).  Note you can use filter() in MATLAB to generate the output sequence </span><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;Y&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAjCAYAAADMibkBAAADvElEQVRoQ+3ZWai1UxzH8c8bGTJndoEbcWEocoMMF+Z5yPCaEkKmDJnJcEEyXRBCKbMMGcp4I1PEBTeSC5GIDJmSWb9aT60e+3n3c87eZx/bOU+di9Nez1rru/7T77+eJRbos2SBcpsU+AY4EisOOOgn8NGIBtgXWw6Y41M8jt/av00KfHPch5/we2sTl+DdEcHPxH6tOVbHezgHv8wn+JU4A9+MCNn39R1x7CJ467gm6epTYfFNcCIOR+KzeZ7Fy7i/ctm41D44tBr7As7Gh+XFzDEV4A3ozngYG+JVLMVnHUF2Oa7G7bgQP1bjpg58nZKN9yol5zC8PwB8PdyF9UtCaZenqQNfDtfg4gKbWvxICzxjzsXpOB6vDDiYqQMPwwF4qsBci7j0nxXcLsXaieGH8Pf/BTzWipW3wfPFlb8ucJuVUHgSN+KPjvifSouvhtsK8BfYvyitVXA91sUp+G4ZymIqwcMT2XdTATsV9+A8HIwT8MEQOdUHPJpizVISt8X2SP5IWcyhboqzcAh+wGV4ehnrjkW5ZZLnEOsne7+D83FyRzJr76cPeObetTrMzJHDvQV7lNwS7R3NEJ3xGE7C9x3wYwHfCA+UjWWd1OhYviuZzQa8eScbfq2ssTeWx2nlEL7FzSW00vSkktR6oV53LOAr4Lri8pk8iexS/DrExZuf+1i8GZt8cUdJpKkix5W1vsRaJZmmDY035BAGVZHMNRbwOsFl0rjeSz2hM6wv+MqVRRNSaS1vKKGVebbAoyXe4w2vz3WM1yXtjSJdP5kD8MTug9gBqSAXlBBrrNpoivQL8YSM6XrGYvFaxNzZ1eOOoZztjhfLPLF4qsnP5f9aRQ4SUu3lRwZvy9YktcDP5Onj6ilnyRuRyLHkQXi7WqTuGw4cUsrGEuP1grWAGTf4GrgbaYQGedV2eAZf4Yiq5Z0zV28WTGvalqx94ftYfOtSmyOD09vnErJ+mmzflLGVkL0lNP4asJGRXb1WbSkfFw26tRxyAn3Ajy4XHG/hKHxczVln+3SC8YzsIxciXapxJPCNcS92K5u4Cvnrqp1d/MPAa50wyM3XLtl9T9yKVcu+BrXAzR5mBZ6XUieTzbeqaKKcchC5hUnH9nlPXx8GXivDYwpkPXWj2dP6JuFdgTeHGGBW4D15eg8bBt57ohkMXASf7w8Kqc/5atLu29Nk/OsTzwwsm6GJ+fbnqbS10QLz/iWlucVpM+00RHP3OYPmhrc9tlNlTuqDQp/NT3TMIvhEj/s/sNiCtfg/cVMbMym8ld0AAAAASUVORK5CYII=" width="31" height="17.5" /></span><span>.</span></li></ol><ul  class = 'S3'><li  class = 'S4'><span>Plot the probability density function of Y[i], i=1,2,..., N. Explain the results.</span></li><li  class = 'S4'><span>Draw 4 scatter plots using </span><span>subplot</span><span>(22</span><span>n</span><span>), </span><span>n</span><span>=1,2,3,4. The first scatter plot should </span><span>consist of points (</span><span>Y</span><span>[</span><span>i</span><span>],</span><span> Y</span><span> [</span><span>i</span><span> +1])</span><span>. T</span><span>his correlates samples that are separated by a lag </span><span>of “1”. The other</span><span> 3 scatter plots should consist</span><span> of points (</span><span>Y</span><span>[</span><span>i</span><span>],</span><span> Y</span><span> [</span><span>i</span><span> +2]), (</span><span>Y</span><span>[</span><span>i</span><span>],</span><span> Y</span><span> [</span><span>i</span><span>+3]), (</span><span>Y</span><span>[</span><span>i</span><span>],</span><span> Y</span><span> [</span><span>i</span><span> +4]), I =</span><span> 1, 2, ..., </span><span>N</span><span>-10, respectively. What can you conclude</span><span> about </span><span>the output random process from all the</span><span> plots?</span></li></ul><ol  class = 'S3'><li  class = 'S4'><span>Evaluate the autocorrelation function RY[m] from the sample autocorrelation of Y[n]. Plot both the theoretical autocorrelation and the sample autocorrelation versus 𝑚𝑚 for  −20≤𝑚𝑚≤20. Note it is necessary to take the ensemble average of the function of interest.  Explain any discrepancies.</span></li><li  class = 'S4'><span>Evaluate the power spectral density function of Y[n]   by (a) periodogram (don’t use the built-in function), and (b) DTFT of the autocorrelation function. Note these may be evaluated using fft() from MATLAB. To get reasonable results, it is necessary to take the ensemble average of the functions of interest. Again compare these with the theoretical results and explain any discrepancies.</span></li><li  class = 'S4'><span>Is there any relationship between the input and output PSDs? Why or why not?</span></li><li  class = 'S4'><span>Repeat steps 2-5 with the following system</span></li></ol><div  class = 'S5'><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;y&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;-&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mn&gt;95&lt;/mn&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;y&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;mo&gt;-&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;x&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="168.5" height="17.5" /></span><span> (2)</span></div><h2  class = 'S6'><span>Mean Function</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>mu = average(S)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    mu = sum(S)/length(S);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h3  class = 'S7'><span>Variance Function</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>sigma_2 = </span><span class="warning_squiggle_rte1043115941">variance</span><span>(S)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sigma_2 = sum((S-average(S)).^2)/(length(S)-1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h3  class = 'S7'><span>Autocorrelation Function</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>R = </span><span class="warning_squiggle_rte1043115941">autocorrelation</span><span>(sample)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    N = length(sample);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    R = zeros(length(N), 1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    sample_avg = average(sample);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>n = 0:round(sqrt(N))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        sum1 = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        sum2 = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">for </span><span>k = 1:(N-n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            sum1 = sum1 + (sample(k)-sample_avg)*(sample(k+n)-sample_avg);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>            sum2 = sum2 + (sample(k)-sample_avg)^2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>        R(n+1) = sum1/sum2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>    R = R';  </span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% EE525 Project 3
% Part 1
% Author: Grant Gallagher

% Clear Workspace
clc;
clear;
% Chose Between FIR and IIR filter
% type == 1: FIR
% type == 2: IIR
type = 1
%%
%% Procedure 1: Simulate the random sequence
N = 50000;              % Sequence size
X = normrnd(0,1,[1 N]); % Generate Gaussian random sequence
maxlag = 20;              % Number of lag points to calculate
Rx = xcorr(X,X,maxlag)/N; % Autocorrelation of X[n]
lags = linspace(-maxlag,maxlag,2*maxlag+1); % Sequence of lags correlating to Rx

figure('Position',[0 0 1000 400]);
% Subplot of random sample sequence
subplot(1,2,1)
plot(X,'Color','Black')
xlabel('Index, {\itn}')
ylabel('Magnitude, {\itX[n]}')
grid on
box on
% Subplot of autocorrelation sequence
subplot(1,2,2)
stem(lags,Rx,'Color','Black')
xlabel('Lag, {\itm}')
ylabel('Autocorrelation, {\itR_x}')
ylim([-0.2 1.2])
grid on
box on
%%
%% Procedure 2: Simulate the filter
if type == 1
    b = [1 -1 1];      % Numerator coefficients
    a = [1  0 0];      % Denominator coefficients
elseif type == 2
    b = [1 0];
    a = [1 -0.95];
end
Y = filter(b,a,X); % Output of filtered random sequence
var(Y);

% Plot the PDF
figure('Position',[0 0 500 400]);
hold on
[f, Yi] = ksdensity(Y);
plot(Yi,f,'Color','Black')
[f, Xi] = ksdensity(X);
plot(Xi,f,'-.','Color','Black')
hold off
xlabel('Magnitude, {\itY[n]}')
ylabel('Density, {\itP(Y[n])}')
legend('Y[n]', ' X[n]')
xlim([-8 8])
grid on
box on

% Four Lag Plots
figure('Position',[0 0 600 600]);
subplot(2,2,1);
plot(Y(1:end-1), Y(2:end),'.','Color',[0 0 0])
xlabel('{\itY[n]}')
ylabel('{\itY[n+1]}')
title('Lag of 1')
subplot(2,2,2);
plot(Y(1:end-2), Y(3:end),'.','Color',[0 0 0])
xlabel('{\itY[n]}')
ylabel('{\itY[n+2]}')
title('Lag of 2')
subplot(2,2,3);
plot(Y(1:end-3), Y(4:end),'.','Color',[0 0 0])
xlabel('{\itY[n]}')
ylabel('{\itY[n+3]}')
title('Lag of 3')
subplot(2,2,4);
plot(Y(1:end-4), Y(5:end),'.','Color',[0 0 0])
xlabel('{\itY[n]}')
ylabel('{\itY[n+4]}')
title('Lag of 4')
%%
%% Procedure 3: Autocorrelation Function
N = 50000;   % Sequence size
maxlag = 20; % Number of lag points to calculate
K = 1000;    % Number of sample sequences for ensemble average

% Memory preallocation
X = zeros(K,N); % Array of sample sequence inputs
Y = zeros(K,N); % Array of sample sequence ouputs
for s = 1:K % Calculate each sample sequence
    X(s,:) = randn([1 N]);
    % Y(s,:) = cos(2*pi/1000*linspace(1,N,N)).*(1+X(s,:));
    Y(s,:) = filter(b, a, X(s,:));
end
% Memory preallocation
x = zeros(1,N); % Ensemble average of input
y = zeros(1,N); % Ensemble average outputs
for n = 1:N     % Take the ensemble average
    x(n) = average(X(:,n));
    y(n) = average(Y(:,n));
end
Ry = xcorr(y,y,maxlag)/N*K; % Autocorrelation of Y[n]
if type == 1
    Ry_theoretical = [zeros([1 18]) [1 -2 3 -2 1] zeros([1 18])];
elseif type == 2
    Ry_theoretical =[10.2564*(0.95.^(flip(m(2:end)))) (10.2564*(0.95.^(m)))]
end

figure('Position',[0 0 1000 400]);
subplot(1,2,1)
stem(lags,Ry,'Color','Black')
xlabel('Lag, {\itm}')
ylabel('Autocorrelation Function, {\itR_Y[m]}')
grid on
subplot(1,2,2)
linspace(-20,20,41)
stem(linspace(-20,20,41), Ry_theoretical,'Color','Black')
xlabel('Lag, {\itm}')
ylabel('Autocorrelation Function, {\itR_Y[m]}')
grid on

%%
%% Procedure 4: PSDs
% FFT of y[n]
figure('Position',[0 0 1000 500]);
Sy = (abs(fft(y)).^2)/N*K;
Sy = Sy(1:N/2+1);
f = (0:N/2)/N;
subplot(3,1,1)
plot(f*2,10*log10(Sy),'Color','Black') 
legend('FFT of Y[n]','Location','NorthEast')
ylim([-40 20])
grid on

% DTFT of Ry
maxlag = N-10;
Ry = xcorr(y,y,maxlag)/N*K;
Sy = abs(fft(Ry));
Sy = Sy(1:maxlag+1);
f = (0:maxlag)/maxlag;
subplot(3,1,2)
plot(f,10*log10(Sy),'Color','Black')
ylabel('Power Spectral Density, {\itS_Y} [dB]')
legend('DTFT of R_Y','Location','NorthEast')
ylim([-40 20])
grid on

% Analytical Solutiun
syms F
if type == 1
    Sy = 3-4*cos(pi*F)+2*cos(2*pi*F);
elseif type == 2
    Sy = 0.102586/((2*F)^2+0.002631) 
end
subplot(3,1,3)
fplot(10*log10(Sy),'Color','Black')
xlabel('Normalized Sample Frequency, {\itf} [\pi\timesrad/sample]')
xlim([0 1])
ylim([-40 20])
legend('Analytical Solution','Location','NorthEast')
grid on
%%
%% Prcedure 5: Compare I/O
N = 100000;              % Sequence size
x = normrnd(0,1,[1 N]); % Generate Gaussian random sequence
if type == 1
    b = [1 -1 1];      % Numerator coefficients
    a = [1  0 0];      % Denominator coefficients
elseif type == 2
    b = [1 0];
    a = [1 -0.95];
end
y = filter(b,a,x); % Output of filtered random sequence

Sx = (abs(fft(x)).^2)/N;
Sx = Sx(1:N/2+1);
Sy = (abs(fft(y)).^2)/N;
Sy = Sy(1:N/2+1);
f = (0:N/2)/N;

figure('Position',[0 0 800 500]);
subplot(1,2,1)
plot(f*2,(Sx),'Color','Black')
ylabel('Power Spectral Density, {\itS_X} [Mag]')
xlabel('Normalized Sample Frequency, {\itf} [\pi\timesrad/sample]')
grid on
ylim([0 80])

subplot(1,2,2)
plot(f*2,(Sy),'Color','Black')
ylabel('Power Spectral Density, {\itS_Y} [Mag]')
xlabel('Normalized Sample Frequency, {\itf} [\pi\timesrad/sample]')
grid on
ylim([0 80])
%% 
% # Filter $X\left\lbrack n\right\rbrack$ using (1).  Note you can use filter() 
% in MATLAB to generate the output sequence $Y\left\lbrack n\right\rbrack$.
%% 
% * Plot the probability density function of Y[i], i=1,2,..., N. Explain the 
% results.
% * Draw 4 scatter plots using subplot(22n), n=1,2,3,4. The first scatter plot 
% should consist of points (Y[i], Y [i +1]). This correlates samples that are 
% separated by a lag of “1”. The other 3 scatter plots should consist of points 
% (Y[i], Y [i +2]), (Y[i], Y [i+3]), (Y[i], Y [i +4]), I = 1, 2, ..., N-10, respectively. 
% What can you conclude about the output random process from all the plots?
%% 
% # Evaluate the autocorrelation function RY[m] from the sample autocorrelation 
% of Y[n]. Plot both the theoretical autocorrelation and the sample autocorrelation 
% versus 𝑚𝑚 for  −20≤𝑚𝑚≤20. Note it is necessary to take the ensemble average 
% of the function of interest.  Explain any discrepancies.
% # Evaluate the power spectral density function of Y[n]   by (a) periodogram 
% (don’t use the built-in function), and (b) DTFT of the autocorrelation function. 
% Note these may be evaluated using fft() from MATLAB. To get reasonable results, 
% it is necessary to take the ensemble average of the functions of interest. Again 
% compare these with the theoretical results and explain any discrepancies.
% # Is there any relationship between the input and output PSDs? Why or why 
% not?
% # Repeat steps 2-5 with the following system
%% 
% $y\left\lbrack n\right\rbrack -0\ldotp 95y\left\lbrack n-1\right\rbrack =x\left\lbrack 
% n\right\rbrack$ (2)
%% Mean Function

function mu = average(S)
    mu = sum(S)/length(S);
end
% Variance Function

function sigma_2 = variance(S)
    sigma_2 = sum((S-average(S)).^2)/(length(S)-1);
end
% Autocorrelation Function

function R = autocorrelation(sample)
    N = length(sample);
    R = zeros(length(N), 1);
    sample_avg = average(sample);
    for n = 0:round(sqrt(N))
        sum1 = 0;
        sum2 = 0;
        for k = 1:(N-n)
            sum1 = sum1 + (sample(k)-sample_avg)*(sample(k+n)-sample_avg);
            sum2 = sum2 + (sample(k)-sample_avg)^2;
        end
        R(n+1) = sum1/sum2;
    end
    R = R';  
end
##### SOURCE END #####
--></body></html>